function [X, t] = Signal_Cascade(X_old, t, N_ph, t_next, h, c, Ca2)

mu = 1;                     % Reaction to perform each dt
av = zeros(1,7);            % For determining mu

%% Phototransduction
X = X_old;

% Determine stochastic time step
r1 = rand;
    
as = dot(h,c);
dt = (1/(la + as)) * log(1/r1);
    
% If our random timestep includes a photon...
if ((t + dt) > t_next)
    t = t_next;
    X(1) = X(1) + N_ph;  
else
    t = t + dt;
end
    
r2 = rand;

% To determine which reaction to perform in this time step
av(1) = dot(h(1:1),c(1:1));   
for k = 2:length(av)
        
    av(k) = dot(h(1:k),c(1:k));
        
    if ((r2*as > av(k-1)) && (r2*as <= av(k)))
        mu = k;
    end
        
end

% Update X(mu)
temp = 0;
for m = 1:12
    temp = temp + V(mu,m)*h(m)*c(m);
end
    
for z = 1:7
    if z == mu
        X(z) = X(z) + temp;
    else
        X(z) = X(z);
    end
end 
end